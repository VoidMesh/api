syntax = "proto3";

package inventory.v1;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/VoidMesh/api/api/proto/inventory/v1";

service InventoryService {
  // Inventory management
  rpc GetCharacterInventory(GetCharacterInventoryRequest) returns (GetCharacterInventoryResponse) {}
  
  // Item management
  rpc AddInventoryItem(AddInventoryItemRequest) returns (AddInventoryItemResponse) {}
  rpc RemoveInventoryItem(RemoveInventoryItemRequest) returns (RemoveInventoryItemResponse) {}
  rpc UpdateItemQuantity(UpdateItemQuantityRequest) returns (UpdateItemQuantityResponse) {}
}

// Inventory item representing any harvestable item in character's inventory
message InventoryItem {
  int32 id = 1;
  string character_id = 2;
  int32 item_id = 3; // References items table
  int32 quantity = 4;
  google.protobuf.Timestamp created_at = 5;
  google.protobuf.Timestamp updated_at = 6;
  
  // Item details (populated from JOIN with items table)
  string item_name = 7;
  string description = 8;
  string item_type = 9;
  string rarity = 10;
  int32 stack_size = 11;
  bytes visual_data = 12; // JSON data for sprite, color, etc.
}

// Get character inventory
message GetCharacterInventoryRequest {
  string character_id = 1;
}

message GetCharacterInventoryResponse {
  repeated InventoryItem items = 1;
  int32 total_items = 2;
}

// Add inventory item
message AddInventoryItemRequest {
  string character_id = 1;
  int32 item_id = 2;
  int32 quantity = 3;
}

message AddInventoryItemResponse {
  InventoryItem item = 1;
  bool success = 2;
  string error_message = 3;
}

// Remove inventory item
message RemoveInventoryItemRequest {
  string character_id = 1;
  int32 item_id = 2;
  int32 quantity = 3;
}

message RemoveInventoryItemResponse {
  InventoryItem item = 1; // Updated item, null if completely removed
  bool success = 2;
  string error_message = 3;
}

// Update item quantity
message UpdateItemQuantityRequest {
  string character_id = 1;
  int32 item_id = 2;
  int32 new_quantity = 3;
}

message UpdateItemQuantityResponse {
  InventoryItem item = 1;
  bool success = 2;
  string error_message = 3;
}